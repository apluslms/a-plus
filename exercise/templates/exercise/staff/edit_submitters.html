{% extends "exercise/exercise_base.html" %}
{% load i18n %}
{% load course %}
{% load bootstrap %}
{% load static %}

{% block title %}{% trans "Edit submitters SID " %} {{ submission.id}} | {{ block.super }}{% endblock %}
{% block view_tag %}assess{% endblock %}

{% block exercisebreadcrumblist %}
{{ block.super }}
<li><a href="{{ exercise|url:'submission-list' }}">{% trans "All submissions"  %}</a></li>
<li><a href="{{ submission|url }}">{% trans "Submission ID" %} {{ submission.id }}</a></li>
<li class="active">{% trans "Edit submitters" %}</li>
{% endblock %}

{% block columns %}
<div class="col-md-12">
      <form method="post" class="well form">
          {% csrf_token %}
          {{ form|bootstrap }}
          <div class="form-group">
              <button type="submit" class="aplus-button--default aplus-button--md">{% trans 'Save' %}</button>
              <a href="{{ submission|url:'submission-inspect' }}" class="aplus-button--secondary aplus-button--md" role="button">{% trans "Cancel" %}</a>
          </div>
      </form>
      {% if groups %}
      <h4>{% trans "Quick select a group" %}</h4>
      <table class="table table-condensed" id="group-select">
        <tbody>
          {% for group in groups %}
          <tr>
            <td class="col-md-1">
              <a href="#" class="aplus-button--secondary aplus-button--xs select" role="button" data-profiles="{% for profile in group.members.all %}{{ profile.user.id }},{% endfor %}">
                {% trans "Select" %}
              </a>
            </td>
            <td class="col-md-1">{{ group.id }}</td>
            <td>{% profiles group.members.all instance is_teacher %}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% endif %}
</div>
{% endblock %}

{% block scripts %}
{{ block.super }}
<script src="{% static 'js/ajax_search_select.js' %}"></script>
<script>
$(function() {
  $('#group-select a.select').on('click', function(event) {
    event.preventDefault();
    $('select.search-select-ajax').aplusSearchSelectAjax(
      {},
      $(this).attr("data-profiles").split(",").slice(0,-1)
    );
  });
});
</script>
{% endblock scripts %}
